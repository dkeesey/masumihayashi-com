---
import { getCollection } from 'astro:content';
import ArtworkCard from '@components/ArtworkCard.astro';
import GalleryScrollLayout from '@layouts/GalleryScrollLayout.astro';
import GalleryNavigation from '@components/GalleryNavigation.astro';
import GalleryKeyboardHints from '@components/GalleryKeyboardHints.astro';
import type { CollectionEntry } from 'astro:content';
import type { ArtworkEntry } from '../../../types/artwork';
import { generateSEOTags, type SEOConfig } from "@utils/seo";

const CURRENT_SERIES_SLUG = 'post-industrial';
const CURRENT_SERIES_NAME = 'Post-Industrial Landscapes';

const allEntries: CollectionEntry<'artwork'>[] = await getCollection("artwork");
const artworks: ArtworkEntry[] = allEntries.filter(
  (entry) => entry.data.series === CURRENT_SERIES_NAME
);

const seoConfig: SEOConfig = {
  title: "Post-Industrial Landscapes - Rust Belt Documentation",
  description: "Panoramic photo collages documenting abandoned factories and industrial sites across America's Rust Belt.",
  keywords: ["post-industrial", "Rust Belt", "abandoned factories", "urban decay", "industrial photography", "Youngstown Ohio"],
  type: "article" as const,
  image: artworks[0]?.data.cloudinaryId
};

const seoTags = generateSEOTags(seoConfig);
---

<GalleryScrollLayout
  title="Post-Industrial Landscapes"
  description="Panoramic photo collages of abandoned industrial sites across America's Rust Belt"
  artworkCount={artworks.length}
  seoTags={seoTags}
>

  <GalleryKeyboardHints />

  {artworks.map((artwork, index) => (
    <ArtworkCard
      artwork={artwork}
      index={index}
      total={artworks.length}
      seriesName={CURRENT_SERIES_NAME}
      isFirst={index === 0}
    />
  ))}
  <!-- Gallery Navigation - Next/Previous Series -->
  <GalleryNavigation currentSeries="Post-Industrial Landscapes" />
</GalleryScrollLayout>

<script>
  // Infinite scroll: Load next series when approaching bottom
  import { initInfiniteScroll } from '../../../scripts/gallery-infinite-scroll';

  initInfiniteScroll('post-industrial');
</script>
