---
import { getCollection } from 'astro:content';
import GalleryScrollLayout from '@layouts/GalleryScrollLayout.astro';
import GalleryNavigation from '@components/GalleryNavigation.astro';
import GalleryKeyboardHints from '@components/GalleryKeyboardHints.astro';
import ArtworkCard from '@components/ArtworkCard.astro';
import type { CollectionEntry } from 'astro:content';
import type { ArtworkEntry } from '../../../types/artwork';
import { generateSEOTags, type SEOConfig } from "@utils/seo";

const CURRENT_SERIES_SLUG = 'japanese-american-internment-camps';
const CURRENT_SERIES_NAME = 'Japanese-American Internment Camps';

const allEntries: CollectionEntry<'artwork'>[] = await getCollection("artwork");
const artworks: ArtworkEntry[] = allEntries.filter(
  (entry) => entry.data.series === CURRENT_SERIES_NAME
);

const seoConfig: SEOConfig = {
  title: "Japanese-American Internment Camps",
  description: "Panoramic photo collages documenting WWII Japanese-American incarceration sites",
  keywords: [],
  type: "article" as const,
  image: artworks[0]?.data.cloudinaryId
};

const seoTags = generateSEOTags(seoConfig);
---

<GalleryScrollLayout
  title="Japanese-American Internment Camps"
  description="Panoramic photo collages documenting WWII Japanese-American incarceration sites"
  artworkCount={artworks.length}
  seoTags={seoTags}
>

  <!-- Keyboard shortcuts hint bar -->
  <GalleryKeyboardHints />

  {artworks.map((artwork, index) => (
    <ArtworkCard
      artwork={artwork}
      index={index}
      total={artworks.length}
      seriesName={CURRENT_SERIES_NAME}
      isFirst={index === 0}
    />
  ))}

  <!-- Gallery Navigation - Next/Previous Series -->
  <GalleryNavigation currentSeries="Japanese-American Internment Camps" />
</GalleryScrollLayout>

<script>
  // Infinite scroll: Load next series when approaching bottom
  import { initInfiniteScroll } from '../../../scripts/gallery-infinite-scroll';

  initInfiniteScroll('japanese-american-internment-camps');
</script>
